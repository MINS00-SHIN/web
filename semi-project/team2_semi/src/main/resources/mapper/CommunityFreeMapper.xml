<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.team2.healthsns.mapper.CommunityFreeMapper">

    <insert id="communityInsertFree">
        insert into board(title, content, userid, board_cat, cat, bodypart)
        values(#{title}, #{content}, #{userid}, #{board_cat}, #{cat}, #{bodypart});
    </insert>



    <select id="totalRecordFree">
        select count(post_id) from board
        where board_cat = 'free'
        <if test="searchWord != null and searchWord != ''">
            AND title like CONCAT('%', #{searchWord}, '%')
        </if>
    </select>

    <select id="communitySelectFree" resultType="com.team2.healthsns.vo.CommunityVO">
        select post_id, title, userid, content, views, date_format(write_date,'%m-%d %h:%i') as write_date
        from board
        where post_id = #{param1}
    </select>

    <update id="hitCountFree">
        update board
        set views = views + 1
        where post_id = #{param1}
    </update>

    <update id="communityUpdateFree">
        update board
        set title = #{title}, content = #{content}
        where post_id = #{post_id}
    </update>

    <update id="communityDeleteFree">
        delete from board
        where post_id = #{param1}
    </update>

    <!--sql문 수정-->
    <select id="communityPageListFree" resultType="com.team2.healthsns.vo.CommunityVO">
        select post_id, title, userid, views, date_format(write_date,'%m-%d %h:%i') as write_date, bodypart
        from board
        where board_cat = 'free'
        <if test="searchWord != null and searchWord != ''">
            AND title like CONCAT('%', #{searchWord}, '%')
        </if>
        order by post_id desc
        limit #{onePageRecord}
        offset #{offsetPoint}
    </select>

</mapper>
